{% extends "store/base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/orders/style.css' %}">
{% endblock %}

{% block title %}Your Orders{% endblock %}

{% block content %}
<div class="orders-container">
    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <a href="{% url 'book_list' %}" class="breadcrumb-link">Home</a>
        <span class="breadcrumb-separator">â€º</span>
        <span class="breadcrumb-current">Your Orders</span>
    </div>

    <!-- Page Header -->
    <h1 class="orders-heading">Your Orders</h1>

    {% if orders %}
    <!-- Orders List -->
    <div class="orders-list">
        {% for order in orders %}
        <div class="order-card">
            <!-- Order Header -->
            <div class="order-header">
                <div class="order-header-left">
                    <div class="header-item">
                        <span class="header-label">ORDER PLACED</span>
                        <span class="header-value">{{ order.created_at|date:"d M Y" }}</span>
                    </div>
                    <div class="header-item">
                        <span class="header-label">TOTAL</span>
                        <span class="header-value">â‚¹{{ order.total|floatformat:2 }}</span>
                    </div>
                    <div class="header-item">
                        <span class="header-label">SHIP TO</span>
                        <span class="header-value">{{ order.full_name|truncatewords:2 }}</span>
                    </div>
                </div>
                <div class="order-header-right">
                    <span class="order-number">ORDER # {{ order.id }}</span>
                </div>
            </div>

            <!-- Order Body -->
            <div class="order-body">
                <!-- Status -->
                <div class="order-status">
                    <span class="status-badge status-{{ order.status|lower }}">{{ order.status }}</span>
                </div>

                <!-- Order Items -->
                {% for item in order.items.all %}
                <div class="order-item">
                    <div class="item-image-wrapper">
                        {% if item.book.image %}
                            <img src="{{ item.book.image.url }}" alt="{{ item.book.title }}" class="item-image">
                        {% else %}
                            <div class="item-image-placeholder">ðŸ“š</div>
                        {% endif %}
                    </div>
                    <div class="item-info">
                        <a href="{% url 'book_detail' item.book.pk %}" class="item-title">{{ item.book.title }}</a>
                        <p class="item-author">by {{ item.book.author }}</p>
                        <div class="item-pricing">
                            <span class="item-qty">Qty: {{ item.quantity }}</span>
                            <span class="item-price">â‚¹{{ item.price|floatformat:2 }}</span>
                        </div>
                        <p class="item-return-info">Return window closed</p>
                    </div>
                    <div class="item-actions">
                        <a href="{% url 'book_detail' item.book.pk %}" class="btn-buy-again">Buy it again</a>
                    </div>
                </div>
                {% endfor %}

                <!-- Delivery Address -->
                <div class="delivery-section">
                    <h4 class="delivery-heading">Delivery Address</h4>
                    <div class="delivery-address">
                        <p class="address-name">{{ order.full_name }}</p>
                        <p class="address-text">{{ order.address }}</p>
                        <p class="address-text">{{ order.city }}, {{ order.pincode }}</p>
                        <p class="address-phone">{{ order.phone }}</p>
                    </div>
                </div>

                <!-- Payment Method -->
                <div class="payment-section">
                    <h4 class="payment-heading">Payment Method</h4>
                    <p class="payment-info">{{ order.payment_method }}</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    {% else %}
    <!-- Empty State -->
    <div class="empty-orders-state">
        <div class="empty-content">
            <h2 class="empty-title">No orders yet</h2>
            <p class="empty-text">Looks like you haven't placed any orders.</p>
            <a href="{% url 'book_list' %}" class="btn-start-shopping">Start shopping</a>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}