{% extends "store/base.html" %}
{% load static%}
{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/checkout/style.css' %}">
{% endblock %}
{% block content %}
<div class="checkout-container">
    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <a href="{% url 'book_list' %}" class="breadcrumb-link">Books</a>
        <span class="breadcrumb-separator">â€º</span>
        <a href="{% url 'view_cart' %}" class="breadcrumb-link">Cart</a>
        <span class="breadcrumb-separator">â€º</span>
        <span class="breadcrumb-current">Checkout</span>
    </div>

    {% if cart_items %}
    <div class="checkout-layout">
        <!-- Left: Form Section -->
        <div class="checkout-main">
            <h1 class="checkout-heading">Checkout</h1>

            <form method="post" action="{% url 'checkout' %}" class="checkout-form" id="checkout-form">
                {% csrf_token %}
                
                <!-- Delivery Address -->
                <div class="checkout-section">
                    <div class="section-header">
                        <span class="section-number">1</span>
                        <h2 class="section-title">Delivery address</h2>
                    </div>

                    <div class="form-content">
                        <div class="form-row">
                            <div class="form-group full">
                                <label for="full_name" class="field-label">Full name</label>
                                <input type="text" name="full_name" id="full_name" 
                                       class="field-input" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group full">
                                <label for="phone" class="field-label">Mobile number</label>
                                <input type="tel" name="phone" id="phone" 
                                       class="field-input" placeholder="10-digit mobile number" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group half">
                                <label for="pincode" class="field-label">Pincode</label>
                                <input type="text" name="pincode" id="pincode" 
                                       class="field-input" placeholder="6 digits [0-9] PIN code" 
                                       maxlength="6" required>
                            </div>

                            <div class="form-group half">
                                <label for="city" class="field-label">Town/City</label>
                                <input type="text" name="city" id="city" 
                                       class="field-input" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group full">
                                <label for="address" class="field-label">Address</label>
                                <textarea name="address" id="address" 
                                          class="field-textarea" rows="3" 
                                          placeholder="Flat, House no., Building, Company, Apartment" 
                                          required></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Payment Method -->
                <div class="checkout-section">
                    <div class="section-header">
                        <span class="section-number">2</span>
                        <h2 class="section-title">Payment method</h2>
                    </div>

                    <div class="form-content">
                        <div class="payment-methods">
                            <label class="payment-option">
                                <input type="radio" name="payment_method" value="COD" 
                                       class="payment-radio" checked>
                                <span class="payment-text">Cash on Delivery/Pay on Delivery</span>
                            </label>

                            <label class="payment-option">
                                <input type="radio" name="payment_method" value="UPI" 
                                       class="payment-radio">
                                <span class="payment-text">UPI</span>
                            </label>

                            <label class="payment-option">
                                <input type="radio" name="payment_method" value="Card" 
                                       class="payment-radio">
                                <span class="payment-text">Credit or Debit Card</span>
                            </label>

                            <label class="payment-option">
                                <input type="radio" name="payment_method" value="NetBanking" 
                                       class="payment-radio">
                                <span class="payment-text">Net Banking</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Review Items -->
                <div class="checkout-section">
                    <div class="section-header">
                        <span class="section-number">3</span>
                        <h2 class="section-title">Review items and delivery</h2>
                    </div>

                    <div class="form-content">
                        <div class="items-review">
                            {% for item in cart_items %}
                            <div class="review-item">
                                <div class="review-image">
                                    {% if item.book.image %}
                                        <img src="{{ item.book.image.url }}" alt="{{ item.book.title }}">
                                    {% else %}
                                        <div class="review-placeholder">ðŸ“š</div>
                                    {% endif %}
                                </div>
                                <div class="review-details">
                                    <p class="review-title">{{ item.book.title }}</p>
                                    <p class="review-author">by {{ item.book.author }}</p>
                                    <p class="review-price">â‚¹{{ item.book.price }}</p>
                                    <p class="review-qty">Qty: {{ item.quantity }}</p>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <!-- Place Order Button -->
                <div class="place-order-section">
                    <button type="submit" class="btn-place-order">Place your order</button>
                    <p class="order-terms">By placing your order, you agree to our terms and conditions.</p>
                </div>
            </form>
        </div>

        <!-- Right: Order Summary -->
        <div class="checkout-sidebar">
            <div class="summary-box">
                <button type="submit" form="checkout-form" class="btn-place-order-top">Place your order</button>
                
                <p class="summary-notice">By placing your order, you agree to our terms and conditions.</p>

                <hr class="summary-divider">

                <h3 class="summary-heading">Order Summary</h3>

                <div class="summary-line">
                    <span>Items ({{ cart_items|length }}):</span>
                    <span>â‚¹{{ total|floatformat:2 }}</span>
                </div>

                <div class="summary-line">
                    <span>Delivery:</span>
                    <span class="free-text">FREE</span>
                </div>

                <hr class="summary-divider">

                <div class="summary-total">
                    <span class="total-label">Order Total:</span>
                    <span class="total-amount">â‚¹{{ total|floatformat:2 }}</span>
                </div>
            </div>
        </div>
    </div>

    {% else %}
    <!-- Empty Cart -->
    <div class="empty-checkout-state">
        <div class="empty-content">
            <h2 class="empty-heading">Your cart is empty</h2>
            <p class="empty-text">Add items to your cart before checking out.</p>
            <a href="{% url 'book_list' %}" class="btn-continue">Continue Shopping</a>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}