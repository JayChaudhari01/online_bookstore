{% extends "store/base.html" %}
{% load static%}
{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/cart/style.css' %}">
{% endblock %}
{% block content %}
<div class="shopping-cart-container">
    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <a href="{% url 'book_list' %}" class="breadcrumb-link">Books</a>
        <span class="breadcrumb-separator">â€º</span>
        <span class="breadcrumb-current">Shopping Cart</span>
    </div>

    {% if cart_items %}
    <!-- Main Cart Layout -->
    <div class="cart-layout">
        <!-- Left: Cart Items -->
        <div class="cart-items-container">
            <div class="cart-header-section">
                <h1 class="cart-main-title">Shopping Cart</h1>
                <span class="items-count">{{ cart_items|length }} item{{ cart_items|length|pluralize }}</span>
            </div>

            {% for item in cart_items %}
            <div class="cart-item">
                <!-- Product Image -->
                <div class="item-image">
                    {% if item.book.image %}
                        <img src="{{ item.book.image.url }}" alt="{{ item.book.title }}" class="product-img">
                    {% else %}
                        <div class="product-img-placeholder">
                            <span class="img-placeholder-icon">ðŸ“š</span>
                        </div>
                    {% endif %}
                </div>

                <!-- Product Info -->
                <div class="item-info">
                    <a href="{% url 'book_detail' item.book.pk %}" class="item-title">{{ item.book.title }}</a>
                    <p class="item-author">by {{ item.book.author }}</p>
                    <p class="item-stock">In Stock</p>
                    
                    <!-- Quantity & Remove -->
                    <div class="item-actions">
                        <form method="post" action="{% url 'update_cart' item.id %}" class="qty-form">
                            {% csrf_token %}
                            <label for="qty-{{ item.id }}" class="qty-label">Qty:</label>
                            <select name="quantity" id="qty-{{ item.id }}" class="qty-select" onchange="this.form.submit()">
                                {% for i in "12345678910"|make_list %}
                                    <option value="{{ i }}" {% if item.quantity == i|add:0 %}selected{% endif %}>{{ i }}</option>
                                {% endfor %}
                            </select>
                        </form>
                        
                        <span class="action-separator">|</span>
                        
                        <a href="{% url 'delete_from_cart' item.id %}" class="action-link">Delete</a>
                    </div>
                </div>

                <!-- Product Price -->
                <div class="item-price">
                    <span class="price">â‚¹{{ item.book.price }}</span>
                </div>
            </div>
            {% endfor %}

            <!-- Subtotal -->
            <div class="cart-subtotal">
                <span class="subtotal-text">Subtotal ({{ cart_items|length }} item{{ cart_items|length|pluralize }}):</span>
                <span class="subtotal-price">â‚¹{{ total_price }}</span>
            </div>
        </div>

        <!-- Right: Order Summary -->
        <div class="order-summary-container">
            <div class="order-summary-card">
                <div class="summary-subtotal">
                    <span class="summary-subtotal-text">Subtotal ({{ cart_items|length }} item{{ cart_items|length|pluralize }}):</span>
                    <span class="summary-subtotal-price">â‚¹{{ total_price }}</span>
                </div>

                <a href="{% url 'checkout' %}" class="btn-proceed-checkout">Proceed to Checkout</a>
            </div>

            <!-- Delivery Info -->
            <div class="delivery-notice">
                <p class="delivery-text">FREE Delivery on orders over â‚¹500</p>
            </div>
        </div>
    </div>

    {% else %}
    <!-- Empty Cart -->
    <div class="empty-cart-state">
        <div class="empty-cart-content">
            <h2 class="empty-title">Your cart is empty</h2>
            <a href="{% url 'book_list' %}" class="btn-shop-now">Shop now</a>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}